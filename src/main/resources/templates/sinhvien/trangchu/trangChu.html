<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="sinhvien/layouts/header::header"></head>

<body class="d-flex flex-column min-vh-100">

  <!-- Responsive navbar-->
  <nav th:replace="sinhvien/layouts/navBar::navBar"></nav>

  <!-- Page Content-->
  <main class="container px-4 px-lg-5">

    <!-- üîé SEARCH BAR -->
    <section class="my-4">
      <form th:action="@{/}" method="get" class="row g-2 align-items-center">
        <div class="col-12 col-md-9">
          <div class="input-group">
            <span class="input-group-text">üîé</span>
            <input class="form-control" type="text" name="keyword" placeholder="T√¨m theo ti√™u ƒë·ªÅ b√†i vi·∫øt..."
              th:value="${keyword}">
          </div>
        </div>

        <div class="col-12 col-md-3 d-grid">
          <button class="btn btn-primary" type="submit">T√¨m ki·∫øm</button>
        </div>
      </form>
    </section>

   <!-- HERO / DS B√ÄI GHIM (card grid) -->
<section class="my-5"
         th:if="${dsBaiVietGhim != null and !#lists.isEmpty(dsBaiVietGhim)
                 and (keyword == null or #strings.isEmpty(#strings.trim(keyword)))}">

  <div class="d-flex align-items-end justify-content-between mb-3">
    <div>
      <h3 class="fw-semibold mb-0">B√†i vi·∫øt ghim</h3>
      <div class="text-muted small">N·ªôi dung quan tr·ªçng ƒë∆∞·ª£c ghim l√™n ƒë·∫ßu</div>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-12 col-md-6 col-lg-4" th:each="bv : ${dsBaiVietGhim}">
      <div class="card h-100 border-0 shadow-sm">
        <div class="card-body p-4">
          <div class="d-flex align-items-center gap-2 mb-2">
            <span class="badge text-bg-primary">Ghim</span>
            <span class="small text-muted" th:text="${bv.taoLuc != null ? #temporals.format(bv.taoLuc,'dd/MM/yyyy HH:mm') : ''}"></span>
          </div>

          <h5 class="card-title fw-bold mb-2"
              style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;"
              th:text="${bv.tieuDe}">
          </h5>

          <p class="card-text text-muted mb-3"
             style="display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"
             th:text="${bv.noiDung}">
          </p>

          <a class="btn btn-sm btn-outline-primary"
             th:href="@{/BaiViet/{id}(id=${bv.baiVietId})}">
            Xem chi ti·∫øt
          </a>
        </div>
      </div>
    </div>
  </div>
</section>




    <!-- DANH S√ÅCH B√ÄI VI·∫æT -->
    <section id="dsBaiViet" class="mb-5">
      <div class="d-flex align-items-end justify-content-between mb-3">
        <div>
          <h3 class="fw-semibold mb-0">B√†i vi·∫øt m·ªõi</h3>
          <div class="text-muted small">
            <span th:if="${keyword != null and !#strings.isEmpty(keyword)}">
              K·∫øt qu·∫£ t√¨m ki·∫øm cho: <b th:text="${keyword}"></b>
            </span>
            <span th:unless="${keyword != null and !#strings.isEmpty(keyword)}">
              T·ªïng h·ª£p th√¥ng b√°o, s·ª± ki·ªán v√† n·ªôi dung c·∫≠p nh·∫≠t
            </span>
          </div>
        </div>
      </div>

      <!-- ‚úÖ EMPTY STATE -->
      <div class="alert alert-light border shadow-sm py-4 text-center"
        th:if="${dsBaiViet == null or #lists.isEmpty(dsBaiViet)}">
        <div class="fw-semibold mb-1">Kh√¥ng c√≥ k·∫øt qu·∫£ üòÖ</div>
        <div class="text-muted small">Th·ª≠ t·ª´ kh√≥a kh√°c nha.</div>
      </div>


      <!-- ‚úÖ LIST -->
      <div class="row g-4" th:if="${dsBaiViet != null and !#lists.isEmpty(dsBaiViet)}">
        <div class="col-12 col-md-6 col-lg-4" th:each="baiViet : ${dsBaiViet}">
          <div class="card h-100 border-0 shadow-sm">
            <div class="card-body p-4">
              <h5 class="card-title fw-bold mb-2"
                style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;"
                th:text="${baiViet.tieuDe}">
              </h5>

              <p class="card-text text-muted mb-3"
                style="display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"
                th:text="${baiViet.noiDung}">
              </p>

              <div class="d-flex align-items-center justify-content-between">
                <span class="small text-muted" th:text="${baiViet.taoLuc != null ? #temporals.format(baiViet.taoLuc,'dd/MM/yyyy HH:mm') : ''}"></span>
                <a class="btn btn-sm btn-outline-primary" th:href="@{/BaiViet/{id}(id=${baiViet.baiVietId})}">
                  Xem chi ti·∫øt
                </a>
              </div>
            </div>
          </div>
        </div>
        <!-- ‚úÖ PAGINATION -->
        <ul class="pagination justify-content-center mt-4" th:if="${dsBaiViet != null and !#lists.isEmpty(dsBaiViet) }">
          <li class="page-item" th:classappend="${currentpage == 1} ? 'disabled'">
            <a class="page-link" th:href="@{/(pageNo=${currentpage - 1}, keyword=${keyword})}">Previous</a>
          </li>

          <li class="page-item" th:each="i : ${#numbers.sequence(1, totalpage)}"
            th:classappend="${i == currentpage} ? 'active'">
            <a class="page-link" th:href="@{/(pageNo=${i}, keyword=${keyword})}" th:text="${i}">1</a>
          </li>

          <li class="page-item" th:classappend="${currentpage == totalpage} ? 'disabled'">
            <a class="page-link" th:href="@{/(pageNo=${currentpage + 1}, keyword=${keyword})}">Next</a>
          </li>
        </ul>


      </div>

    </section>

  </main>

  <!-- Footer-->
  <footer th:replace="sinhvien/layouts/footer::footer"></footer>

  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script th:src="@{/assets/js/sinhvien.js}"></script>
</body>

</html>